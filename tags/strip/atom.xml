<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>「靡不有初，鲜克有终」 - strip</title>
    <subtitle>blog of david</subtitle>
    <link href="https://wendajiang.github.io/tags/strip/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://wendajiang.github.io"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2023-06-08T00:07:57+00:00</updated>
    <id>https://wendajiang.github.io/tags/strip/atom.xml</id>
    <entry xml:lang="en">
        <title>strip</title>
        <published>2023-06-08T00:07:57+00:00</published>
        <updated>2023-06-08T00:07:57+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://wendajiang.github.io/strip/" type="text/html"/>
        <id>https://wendajiang.github.io/strip/</id>
        <content type="html">&lt;h1 id=&quot;real-world-scenario&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#real-world-scenario&quot; aria-label=&quot;Anchor link for: real-world-scenario&quot;&gt;real-world scenario&lt;&#x2F;a&gt;&lt;&#x2F;h1&gt;
&lt;p&gt;When we release our products, that is cpp project, we &lt;code&gt;strip&lt;&#x2F;code&gt; all files, then we can&#x27;t not compile. The problem is the cpp project&#x27;s dependencies have static library and striped static library can not be linked.&lt;&#x2F;p&gt;
&lt;p&gt;So I google the strip&lt;&#x2F;p&gt;
&lt;h2 id=&quot;strip-execute-binary&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#strip-execute-binary&quot; aria-label=&quot;Anchor link for: strip-execute-binary&quot;&gt;strip execute binary&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;no problem when execute&lt;&#x2F;p&gt;
&lt;h2 id=&quot;strip-object-file&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#strip-object-file&quot; aria-label=&quot;Anchor link for: strip-object-file&quot;&gt;strip object file&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;After strip the object file, and compile it into binary, &lt;strong&gt;link error happen&lt;&#x2F;strong&gt;.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;strip-shared-library&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#strip-shared-library&quot; aria-label=&quot;Anchor link for: strip-shared-library&quot;&gt;strip shared library&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;After strip the shared library, compile success, and run it correctly.&lt;&#x2F;p&gt;
&lt;p&gt;So why the shared library (the .symtab section removed) can run correctly?&lt;&#x2F;p&gt;
&lt;h1 id=&quot;shared-library&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#shared-library&quot; aria-label=&quot;Anchor link for: shared-library&quot;&gt;&lt;a href=&quot;https:&#x2F;&#x2F;wendajiang.github.io&#x2F;shared-library&#x2F;&quot;&gt;Shared library&lt;&#x2F;a&gt;&lt;&#x2F;a&gt;&lt;&#x2F;h1&gt;
&lt;p&gt;Even stripped libraries still must retain the symbols necessary for dynamic linking. There are usually placed in a section named &lt;code&gt;.dynsym&lt;&#x2F;code&gt; and are also pointed to by the entries in the dynamic secion.&lt;&#x2F;p&gt;
&lt;p&gt;I can see that event though the stripped library miss the &lt;code&gt;.symtab&lt;&#x2F;code&gt; section, the &lt;code&gt;.dymsym&lt;&#x2F;code&gt; is still present. In fact, the section table can be removed as well(.e.g with sstrip) and the file will still work. This is because the dynamic linker only uses the program headers(aka the segment table), the &lt;code&gt;DYNAMIC&lt;&#x2F;code&gt; segment corresponds to the &lt;code&gt;.dynamic&lt;&#x2F;code&gt; section and contains information for the dynamic linker.&lt;&#x2F;p&gt;
&lt;p&gt;In the &lt;code&gt;.dynamic&lt;&#x2F;code&gt; section, &lt;code&gt;STRTAB&lt;&#x2F;code&gt; and &lt;code&gt;SYMTAB&lt;&#x2F;code&gt; the two entries are necessary for symbol resolution. The together make up the dynamic symbol table:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#282a36;color:#f8f8f2;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;Symbol&lt;&#x2F;span&gt;&lt;span&gt; table &lt;&#x2F;span&gt;&lt;span style=&quot;color:#f1fa8c;&quot;&gt;&amp;#39;.dynsym&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt; contains 91 entries:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;Num:&lt;&#x2F;span&gt;&lt;span&gt; Value   Size Type     Bind  Vis      Ndx   Name
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;0:&lt;&#x2F;span&gt;&lt;span&gt; 0000000    0  NOTYPE  LOCAL  DEFAULT UND
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;...
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;6:&lt;&#x2F;span&gt;&lt;span&gt; 0000000    0  FUNC    GLOBAL  DEFAULT UND  clock_gettime
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#50fa7b;&quot;&gt;7:&lt;&#x2F;span&gt;&lt;span&gt; 000026e1   88 FUNC    GLOBAL  DEFAULT 7    ifc_init
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;You can see that is contains both &lt;code&gt;UND&lt;&#x2F;code&gt;(undefined) symbols - those required by the library and imported from other .so, and the &#x27;normal&#x27; global symbols which are exported by the library for its users. The exported symbols have their addresses inside the library listed in the Value column.&lt;&#x2F;p&gt;
&lt;h1 id=&quot;reference&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#reference&quot; aria-label=&quot;Anchor link for: reference&quot;&gt;reference&lt;&#x2F;a&gt;&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;https:&#x2F;&#x2F;reverseengineering.stackexchange.com&#x2F;questions&#x2F;2038&#x2F;how-are-stripped-shared-libraries-linked-against&lt;&#x2F;li&gt;
&lt;li&gt;http:&#x2F;&#x2F;wen00072.github.io&#x2F;blog&#x2F;2015&#x2F;11&#x2F;16&#x2F;tan-tan-strip&#x2F;&lt;&#x2F;li&gt;
&lt;li&gt;https:&#x2F;&#x2F;www.internalpointers.com&#x2F;post&#x2F;journey-across-static-dynamic-libraries&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;futher-read&quot;&gt;&lt;a class=&quot;zola-anchor&quot; href=&quot;#futher-read&quot; aria-label=&quot;Anchor link for: futher-read&quot;&gt;futher read&lt;&#x2F;a&gt;&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;https:&#x2F;&#x2F;tldp.org&#x2F;HOWTO&#x2F;Program-Library-HOWTO&#x2F;index.html&lt;&#x2F;li&gt;
&lt;li&gt;how to write shared library [Ulrich Drepper]&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
    </entry>
</feed>
